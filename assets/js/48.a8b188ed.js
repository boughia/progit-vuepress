(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{455:function(t,e,s){"use strict";s.r(e);var i=s(28),a=Object(i.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"go-git"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-git"}},[t._v("#")]),t._v(" go-git")]),t._v(" "),s("p",[t._v("\nIn case you want to integrate Git into a service written in Golang, there also is a pure Go library implementation.\nThis implementation does not have any native dependencies and thus is not prone to manual memory management errors.\nIt is also transparent for the standard Golang performance analysis tooling like CPU, Memory profilers, race detector, etc.")]),t._v(" "),s("p",[t._v("go-git is focused on extensibility, compatibility and supports most of the plumbing APIs, which is documented at "),s("a",{staticClass:"link",attrs:{href:"https://github.com/src-d/go-git/blob/master/COMPATIBILITY.md"}},[t._v("https://github.com/src-d/go-git/blob/master/COMPATIBILITY.md")]),t._v(".")]),t._v(" "),s("p",[t._v("Here is a basic example of using Go APIs:")]),t._v(" "),s("pre",{staticClass:"source language-go"},[s("code",[s("span",{staticStyle:{"font-weight":"bold"}},[t._v("import")]),t._v(" \t"),s("span",{staticStyle:{"font-style":"italic"}},[t._v('"gopkg.in/src-d/go-git.v4"')]),t._v("\n\nr, err := git.PlainClone("),s("span",{staticStyle:{"font-style":"italic"}},[t._v('"/tmp/foo"')]),t._v(", "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("false")]),t._v(", &git.CloneOptions{\n    URL:      "),s("span",{staticStyle:{"font-style":"italic"}},[t._v('"https://github.com/src-d/go-git"')]),t._v(",\n    Progress: os.Stdout,\n})")])]),t._v(" "),s("p",[t._v("As soon as you have a "),s("code",{staticClass:"literal"},[t._v("Repository")]),t._v(" instance, you can access information and perform mutations on it:")]),t._v(" "),s("pre",{staticClass:"source language-go"},[s("code",[s("span",{staticStyle:{"font-style":"italic"}},[t._v("// retrieves the branch pointed by HEAD")]),t._v("\nref, err := r.Head()\n\n"),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// get the commit object, pointed by ref")]),t._v("\ncommit, err := r.CommitObject(ref.Hash())\n\n"),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// retrieves the commit history")]),t._v("\nhistory, err := commit.History()\n\n"),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// iterates over the commits and print each")]),t._v("\n"),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("for")]),t._v(" _, c := "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("range")]),t._v(" history {\n    fmt.Println(c)\n}")])]),t._v(" "),s("h2",{attrs:{id:"advanced-functionality"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#advanced-functionality"}},[t._v("#")]),t._v(" Advanced Functionality")]),t._v(" "),s("p",[t._v("go-git has few notable advanced features, one of which is a pluggable storage system, which is similar to Libgit2 backends.\nThe default implementation is in-memory storage, which is very fast.")]),t._v(" "),s("pre",{staticClass:"source language-go"},[s("code",[t._v("r, err := git.Clone(memory.NewStorage(), "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("nil")]),t._v(", &git.CloneOptions{\n    URL: "),s("span",{staticStyle:{"font-style":"italic"}},[t._v('"https://github.com/src-d/go-git"')]),t._v(",\n})")])]),t._v(" "),s("p",[t._v("Pluggable storage provides many interesting options.\nFor instance, "),s("a",{staticClass:"link",attrs:{href:"https://github.com/src-d/go-git/tree/master/_examples/storage"}},[t._v("https://github.com/src-d/go-git/tree/master/_examples/storage")]),t._v(" allows you to store references, objects, and configuration in an Aerospike database.")]),t._v(" "),s("p",[t._v("Another feature is a flexible filesystem abstraction.\nUsing "),s("a",{staticClass:"link",attrs:{href:"https://godoc.org/github.com/src-d/go-billy#Filesystem"}},[t._v("https://godoc.org/github.com/src-d/go-billy#Filesystem")]),t._v(" it is easy to store all the files in different way i.e by packing all of them to a single archive on disk or by keeping them all in-memory.")]),t._v(" "),s("p",[t._v("Another advanced use-case includes a fine-tunable HTTP client, such as the one found at "),s("a",{staticClass:"link",attrs:{href:"https://github.com/src-d/go-git/blob/master/_examples/custom_http/main.go"}},[t._v("https://github.com/src-d/go-git/blob/master/_examples/custom_http/main.go")]),t._v(".")]),t._v(" "),s("pre",{staticClass:"source language-go"},[s("code",[t._v("customClient := &http.Client{\n\tTransport: &http.Transport{ "),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// accept any certificate (might be useful for testing)")]),t._v("\n\t\tTLSClientConfig: &tls.Config{InsecureSkipVerify: "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("true")]),t._v("},\n\t},\n\tTimeout: 15 * time.Second,  "),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// 15 second timeout")]),t._v("\n\t\tCheckRedirect: "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("func")]),t._v("(req *http.Request, via []*http.Request) "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("error")]),t._v(" {\n\t\t"),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("return")]),t._v(" http.ErrUseLastResponse "),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// don't follow redirect")]),t._v("\n\t},\n}\n\n"),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// Override http(s) default protocol to use our custom client")]),t._v("\nclient.InstallProtocol("),s("span",{staticStyle:{"font-style":"italic"}},[t._v('"https"')]),t._v(", githttp.NewClient(customClient))\n\n"),s("span",{staticStyle:{"font-style":"italic"}},[t._v("// Clone repository using the new client if the protocol is https://")]),t._v("\nr, err := git.Clone(memory.NewStorage(), "),s("span",{staticStyle:{"font-weight":"bold"}},[t._v("nil")]),t._v(", &git.CloneOptions{URL: url})")])]),t._v(" "),s("h2",{attrs:{id:"further-reading"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#further-reading"}},[t._v("#")]),t._v(" Further Reading")]),t._v(" "),s("p",[t._v("A full treatment of go-git’s capabilities is outside the scope of this book.\nIf you want more information on go-git, there’s API documentation at "),s("a",{staticClass:"link",attrs:{href:"https://godoc.org/gopkg.in/src-d/go-git.v4"}},[t._v("https://godoc.org/gopkg.in/src-d/go-git.v4")]),t._v(", and a set of usage examples at "),s("a",{staticClass:"link",attrs:{href:"https://github.com/src-d/go-git/tree/master/_examples"}},[t._v("https://github.com/src-d/go-git/tree/master/_examples")]),t._v(".")])])}),[],!1,null,null,null);e.default=a.exports}}]);